<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
  integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
  crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
  integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
  crossorigin=""></script>

 <script type="text/javascript" src='../static/js/leaflet.ChineseTmsProviders.js'></script>

<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

<style>
	html, body {
		height: 100%;
		margin: 0;
	}
	#map {
		width: 1000px;
		height: 800px;
	}
</style>


<div style="float:left">
<div id='map' style="float:left"></div>

<div style="float:left">
<h1>选择线路</h1>
<select  onchange="select(this)">
  {{range .nameList}}
  <option value ="{{.}}">{{.}}</option>
  {{end}}
</select>
</div>
</div>

<script>

	//标记聚合(根据不同缩放级别显示不同数量)
	//https://github.com/MazeMap/Leaflet.LayerGroup.Collision
	//动画效果显示路段
	//https://rubenspgcavalcante.github.io/leaflet-ant-path/

	var normalm = L.tileLayer.chinaProvider('GaoDe.Normal.Map', {
    maxZoom: 18,
    minZoom: 5
	});
	var imgm = L.tileLayer.chinaProvider('GaoDe.Satellite.Map', {
    maxZoom: 18,
    minZoom: 5
	});
	var imga = L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion', {
	    maxZoom: 18,
	    minZoom: 5
	});

	var normal = L.layerGroup([normalm]),
	    image = L.layerGroup([imgm, imga]);

	
	var map = L.map('map', {
		center: [38.52970803,117.2849699],
		zoom: 14,
		layers: [normal],
	});
	
	
	L.marker([34.780889,113.727811]).bindPopup('This is Littleton, CO.').addTo(map),
	L.marker([34.772923, 113.735793]).bindPopup('This is Denver, CO.').addTo(map),
	L.marker([34.767353, 113.727811]).bindPopup('This is Aurora, CO.').addTo(map),
	L.marker([34.772405,113.718082]).bindPopup('This is Golden, CO.').addTo(map);

	var myLines = [{"type":"LineString","coordinates":[[117.2849699,38.52970803],[117.2847251,38.53015596]]},{"type":"LineString","coordinates":[[117.305919,38.49923097],[117.305649,38.499498],[117.3055792,38.49957297],[117.3045679,38.50055001],[117.302872,38.50222599],[117.3010612,38.50398702],[117.3008318,38.50422804],[117.300316,38.50475103],[117.299853,38.50529301],[117.299092,38.50613298],[117.2981581,38.50723503],[117.2971339,38.50850196],[117.2964719,38.50936299],[117.2958109,38.51025399],[117.2951741,38.51124102],[117.2945059,38.51223399],[117.2937391,38.51350902],[117.2933309,38.51425503],[117.2918689,38.51687799],[117.291335,38.51788104],[117.2906842,38.51918901]]},{"type":"LineString","coordinates":[[117.285205,38.52979002],[117.2849782,38.53021203]]},{"type":"LineString","coordinates":[[117.2906842,38.51918901],[117.2889428,38.522475],[117.2887711,38.52277497],[117.2885242,38.52326601],[117.2883701,38.52357201],[117.2882491,38.523807],[117.2881951,38.523924],[117.288067,38.524167],[117.2879359,38.52441999],[117.287509,38.52527598]]},{"type":"LineString","coordinates":[[117.287509,38.52527598],[117.2868019,38.526642]]},{"type":"LineString","coordinates":[[117.2866259,38.52655704],[117.2863951,38.52697896],[117.2863541,38.52704799],[117.2855311,38.52865098],[117.2849699,38.52970803]]},{"type":"LineString","coordinates":[[117.290057,38.51995203],[117.2895541,38.52095904],[117.2893939,38.52126396],[117.289341,38.52137304],[117.2891851,38.52166599],[117.2889652,38.52209502],[117.2887261,38.52256401],[117.2885872,38.52285102],[117.288355,38.52329598]]},{"type":"LineString","coordinates":[[117.288355,38.52329598],[117.2881141,38.523762],[117.288,38.52396297],[117.2878769,38.524185],[117.2877631,38.52437796],[117.2873272,38.52522603]]},{"type":"LineString","coordinates":[[117.282154,38.53474704],[117.282209,38.53467297],[117.2827879,38.533797],[117.2835562,38.53258596]]},{"type":"LineString","coordinates":[[117.2835562,38.53258596],[117.2836958,38.53235403],[117.2842031,38.53154502],[117.2847622,38.53059903],[117.2849558,38.53025397],[117.2849782,38.53021203]]},{"type":"LineString","coordinates":[[117.273029,38.54600901],[117.2788819,38.53891404],[117.2791019,38.53863297],[117.279909,38.53756197],[117.2805649,38.536641],[117.2812219,38.53573101],[117.2816039,38.53515897],[117.2819722,38.53459998],[117.282559,38.53373103],[117.2834572,38.53228599],[117.283968,38.531475],[117.2845199,38.530539],[117.2847251,38.53015596]]},{"type":"LineString","coordinates":[[117.2873272,38.52522603],[117.2869499,38.52594702]]},{"type":"LineString","coordinates":[[117.2869499,38.52594702],[117.2866259,38.52655704]]},{"type":"LineString","coordinates":[[117.2868019,38.526642],[117.2865679,38.52710001],[117.286524,38.52717498],[117.2863969,38.52744201],[117.2862241,38.52778302],[117.2856308,38.52893304]]},{"type":"LineString","coordinates":[[117.2856308,38.52893304],[117.285205,38.52979002]]},{"type":"LineString","coordinates":[[117.2720812,38.54830302],[117.2721391,38.54822499],[117.2724689,38.54774403],[117.2726399,38.54746296],[117.2727742,38.54718099],[117.272839,38.54696202],[117.2728822,38.54674998],[117.272911,38.54661201],[117.272948,38.54651598],[117.273011,38.54640501],[117.2791361,38.53895904],[117.279337,38.53871802],[117.2801491,38.53764],[117.280805,38.53670904],[117.2814559,38.53579896],[117.281839,38.53522296],[117.282154,38.53474704]]},{"type":"LineString","coordinates":[[117.271048,38.54771199],[117.271121,38.54764503],[117.271251,38.54753397],[117.2727061,38.54639997],[117.273029,38.54600901]]},{"type":"LineString","coordinates":[[117.305667,38.49923601],[117.3054859,38.49940296],[117.3054082,38.49947604],[117.3043879,38.50047396],[117.302688,38.50214301],[117.300803,38.50404003],[117.300101,38.50478199],[117.29938,38.50558497],[117.2989649,38.506023],[117.2979511,38.50722999],[117.2963909,38.50919703],[117.2956129,38.51027802],[117.2948479,38.51139501],[117.2945228,38.51188101],[117.2938561,38.51290503],[117.2928701,38.51453403],[117.2922721,38.51562897],[117.291694,38.51675901],[117.291136,38.51786799],[117.2905942,38.51890902],[117.290502,38.51907804],[117.2903281,38.51942103],[117.2900948,38.51989596],[117.290057,38.51995203]]},{"type":"LineString","coordinates":[[117.322083,38.47136103],[117.3219232,38.4723],[117.32166,38.47361697],[117.3215059,38.474379],[117.3213911,38.47484601],[117.3210502,38.47615704],[117.320909,38.47661199],[117.3207269,38.477259],[117.3204389,38.47813398],[117.3202358,38.47875399],[117.3198172,38.47986504],[117.3194258,38.48086296],[117.319212,38.48138496],[117.3186709,38.48256396],[117.3181691,38.48362704],[117.317488,38.48494203],[117.317075,38.48571297],[117.3164242,38.48681097],[117.315671,38.48802804],[117.3154871,38.48831001],[117.3154489,38.48836599],[117.315315,38.48856003],[117.314879,38.48921604],[117.3145838,38.48962104],[117.313744,38.49077304],[117.3131791,38.49152004],[117.3124699,38.49238197],[117.3119371,38.49305904],[117.3112391,38.49383304],[117.3107048,38.49442596],[117.3099251,38.49526503],[117.3093401,38.495862],[117.30847,38.496735],[117.3080261,38.49715602],[117.3078068,38.49737499],[117.3069691,38.49821496],[117.3059179,38.49923304]]},{"type":"LineString","coordinates":[[117.321957,38.47124799],[117.321795,38.47217904],[117.3215362,38.473497],[117.3213742,38.47425696],[117.321268,38.47472703],[117.3209288,38.476035],[117.3207931,38.476485],[117.320602,38.47713003],[117.320314,38.47800798],[117.3201052,38.478618],[117.319702,38.47973202],[117.3193171,38.480733],[117.319095,38.48124204],[117.3185572,38.48242797],[117.3180589,38.48349096],[117.3173782,38.48480901],[117.3169552,38.48555601],[117.316318,38.48666301],[117.3153488,38.48822199],[117.3153391,38.48824701],[117.315198,38.48847498],[117.314806,38.48905503],[117.314496,38.48947398],[117.3140989,38.48999004],[117.3136439,38.49061302],[117.3130762,38.49134904],[117.312372,38.49222204],[117.311827,38.49289002],[117.311134,38.49365601],[117.310599,38.49426198],[117.3098279,38.495097],[117.3092429,38.49568101],[117.308372,38.496564],[117.307922,38.49698502],[117.3077129,38.49720597],[117.30686,38.49804801],[117.3056659,38.49923799]]}];
	
	var myStyle = {
	    "color": "#191970",
	    "weight": 5,
	    "opacity": 0.65
	};
	
	var lineLayer = L.geoJSON(myLines, {
	    style: myStyle
	}).addTo(map);

	var baseLayers = {
		"地图": normal,
		"卫星":image
	};


	L.control.layers(baseLayers, null).addTo(map);
</script>


<script type="text/javascript">

       function select(sel){
       
		 map.removeLayer(lineLayer);

		$.ajax({
				url:"/gis?name="+sel.value,
				success:function(data){
					
					
					lineLayer = L.geoJSON(data, {
						
					    style: myStyle
						
					}).addTo(map);

					var point=data[0].coordinates[0]
					
					console.log(point)					
					
					map.panTo(new L.LatLng(point[0], point[1]));
					
				}
			})	
        }
</script>



